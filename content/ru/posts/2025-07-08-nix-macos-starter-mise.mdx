---
title: "Nix macOS Starter: Декларативная среда разработки с Mise"
description: "Стартовая конфигурация Nix для macOS с использованием nix-darwin, home-manager и mise."
date: "2025-07-08"
tags: [open-source]
---

Я решил заняться Nix в субботу. После нескольких часов работы собрал эту конфигурацию. Огромное спасибо моему другу [Ethan Niser](https://github.com/ethanniser), который подкинул идею и чьей конфигурацией я сначала воспользовался.

Настраивать новый Mac для разработки — боль. Ставишь Homebrew, Node через nvm, Python через pyenv, настраиваешь оболочку, по одной устанавливаешь GUI‑приложения — и надеешься ничего не забыть при смене машины.

Nix делает конфигурацию всей системы декларативной и воспроизводимой, но большинство примеров в сети слишком сложны для новичков или предполагают знание Linux.

[nix-macos-starter](https://github.com/bgub/nix-macos-starter) — это удобная для новичков конфигурация Nix, включающая инструменты разработки (mise для управления средами выполнения, CLI‑утилиты, форматтеры), GUI‑приложения через Homebrew и системные настройки с разумными значениями по умолчанию.

Замените несколько плейсхолдеров, выполните одну команду — и у вас полностью настроенная среда разработки.

## Установка

1. **Установите Nix** с помощью [установщика Determinate Systems](https://docs.determinate.systems/#products). Скачайте графический инсталлер для macOS и перезапустите терминал после установки.

2. **Установите Homebrew** с [brew.sh](https://brew.sh) для GUI‑приложений.

3. **Клонируйте и настройте**:

   ```bash
   git clone https://github.com/bgub/nix-macos-starter ~/.config/nix
   cd ~/.config/nix
   ```

4. **Для Mac на Intel**: замените "aarch64-darwin" на "x86_64-darwin" в `flake.nix`, строка 28.

5. **Замените плейсхолдеры** в этих файлах:

   - `modules/git.nix`: `YOUR_NAME`, `YOUR_EMAIL`, `YOUR_USERNAME`
   - `modules/home-manager.nix`: `YOUR_USERNAME`
   - `platforms/darwin.nix`: `YOUR_USERNAME` (встречается 3 раза)
   - `hosts/my-macbook/configuration.nix`: `YOUR_USERNAME`

6. **Соберите и переключитесь**:
   ```bash
   darwin-rebuild switch --flake .#my-macbook
   ```

После первоначальной настройки используйте алиас `nix-switch` для пересборки конфигурации.

## Настройка

- **Добавить CLI‑инструменты**: Отредактируйте массив `packages` в `modules/home-manager.nix`
- **Добавить GUI‑приложения**: Отредактируйте массив `casks` в `modules/homebrew-common.nix`
- **Добавить инструменты разработки**: Добавьте `${pkgs.mise}/bin/mise use --global tool@version` в скрипт активации в `modules/home-manager.nix`
- **Конфигурация для конкретной машины**: Используйте `hosts/my-macbook/configuration.nix` для пакетов и настроек, специфичных для этой машины

---

**Репозиторий**: [github.com/bgub/nix-macos-starter](https://github.com/bgub/nix-macos-starter)